
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>TTP Editor Prototype</title>

    <!-- placeholders for the theme switcher -->
    <link rel='stylesheet' id='theme_stylesheet'>
    <link rel='stylesheet' id='icon_stylesheet'>

    <style>[class*="foundicon-"] {font-family: GeneralFoundicons;font-style: normal;}</style>
    <script src='dist/jsoneditor.js'></script>
    
</head>
<body>
<div class='container'>
    <div class='row'>
        <div class='span8 col-md-8 columns eight large-8'>
            <h2>JSON Import / Export</h2>
            <p>You can paste the TTP JSON here and update the editor by clicking <button class='btn btn-primary' id='setvalue'>Update Form</button></p>
            <textarea id='output' style='width: 100%; height: 300px; font-family: monospace;' class='form-control'></textarea>
            <h2>Validation</h2>
            <p>This will update whenever the form changes to show validation errors if there are any.</p>
            <textarea id='validate' style='width: 100%; height: 100px; font-family: monospace;' readonly disabled class='form-control'></textarea>
        </div>
        <div class='span4 col-md-4 columns four large-4'>
            <h2>Options</h2>
            <div id='options_holder'>
                <div>
                    <label>TTP Schema</label>
                    <select id='schema_switcher' class='form-control'>
                        <option value='html'>TTPv105</option>
                    </select>
                </div>
                <div>
                    <label>CSS Framework</label>
                    <select id='theme_switcher' class='form-control'>
                        <option value='html'>None</option>
                        <option value='jqueryui'>jQuery UI</option>
                        <option value='bootstrap2'>Bootstrap 2</option>
                        <option value='bootstrap3'>Bootstrap 3</option>
                        <option value='foundation3'>Foundation 3</option>
                        <option value='foundation4'>Foundation 4</option>
                        <option value='foundation5'>Foundation 5</option>
                    </select>
                </div>
                <div>
                    <label>Icon Library</label>
                    <select id='icon_switcher' class='form-control'>
                        <option value=''>None</option>
                        <option value='jqueryui'>jQuery UI</option>
                        <option value='bootstrap2'>Bootstrap 2 Glyphicons</option>
                        <option value='bootstrap3'>Bootstrap 3 Glyphicons</option>
                        <option value='foundation2'>Foundicons 2</option>
                        <option value='foundation3'>Foundicons 3</option>
                        <option value='fontawesome3'>FontAwesome 3</option>
                        <option value='fontawesome4'>FontAwesome 4</option>
                    </select>
                </div>
                <div>
                    <label>Object Layout</label>
                    <select id='object_layout' class='form-control'>
                        <option value='normal'>normal</option>
                        <option value='grid'>grid</option>
                    </select>
                </div>
                <div>
                    <label>Show Errors</label>
                    <select id='show_errors' class='form-control'>
                        <option value='interaction'>On Interaction</option>
                        <option value='change'>On Field Change</option>
                        <option value='always'>Always</option>
                        <option value='never'>Never</option>
                    </select>
                </div>
                <div>
                    <label>Boolean options</label>
                    <select multiple size=9 id='boolean_options' style='width: 100%;' class='form-control'>
                        <option value='required_by_default'>Object properties required by default</option>
                        <option value='no_additional_properties'>No additional object properties</option>
                        <option value='ajax'>Allow loading schemas via Ajax</option>
                        <option value='disable_edit_json'>Disable "Edit JSON" buttons</option>
                        <option value='disable_collapse'>Disable collapse buttons</option>
                        <option value='disable_properties'>Disable properties buttons</option>
                        <option value='disable_array_add'>Disable array add buttons</option>
                        <option value='disable_array_reorder'>Disable array move buttons</option>
                        <option value='disable_array_delete'>Disable array delete buttons</option>
                    </select>
                </div>
            </div>

        </div>
    </div>
    <div class='row'>
        <div class='span12 col-md-12 columns twelve large-12'>
            <h2>TTP Form Editor</h2>
            <p>Below is the editor generated from the JSON Schema.</p>

            <div id='editor'></div>
        <div class='row'>
            <div class='span12 col-md-12 columns twelve large-12'>
                <h2>Schema</h2>
                <p>You can change the schema and see how the generated form looks.  After you make changes, click <button class='btn btn-primary' id='setschema'>Update Schema</button></p>

                <textarea id='schema' style='width: 100%; height: 450px; font-family: monospace;' class='form-control'></textarea>

                <h2>Acknowledgements</h2>
                <p>This editor is based on Jeremy Dorn's MIT licensed JSON editor. See <a href='https://github.com/jdorn/json-editor/'>the code at github.</a></p>

            </div>
        </div>
        </div>
    </div>
</div>
<script>
(function() {
    var schema;

    // Default starting schema
	// schema = loadSchema105;
    if(!schema) {
		schema = {
  "title": "TTP",
  "type": "object",
  "properties": {
    "NDM_metadata": {
      "type": "object",
      "properties": {
        "authority": {
          "type": "string",
          "description": "Creating authority",
          "minLength": 4,
          "default": "org.opennetworking.odwg"
        },
        "type": {
          "type": "string",
          "description": "NDM Type",
          "enum": [
            "TTPv1",
            "TTPv2"
          ]
        },
        "name": {
          "type": "string",
          "description": "NDM Name",
          "minLength": 1,
          "default": "Sample"
        },
        "version": {
          "type": "string",
          "description": "NDM Version",
          "minLength": 1,
          "default": "1.0.0"
        },
        "OF_protocol_version": {
          "type": "string",
          "description": "OF Protocol Version",
          "enum": [
            "1.3.0",
            "1.3.1",
            "1.3.2",
            "1.3.3",
            "1.3.4",
            "1.3.5",
            "1.4",
            "1.5"
          ]
        },
        "doc": {
          "type" : "array",
          "format": "table",
          "title": "Doc",
          "items": {
            "type": "string",
            "title": "Line"
          }
        }
      }
    },
    "identifiers": {
      "type": "array",
      "format": "tabs",
      "title": "Identifiers",
      "uniqueItems": true,
      "items": {
        "oneOf": [
          {
            "type": "object",
            "title": "ID",
            "properties": {
              "id": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "field",
                  "inst",
                  "action",
                  "error"
                ],
                "default": "field"
              },
              "exp_id": {
                "type": "string"
              },
              "exp_code": {
                "type": "string"
              },
              "doc": {
                "type" : "array",
                "format": "table",
                "title": "Doc",
                "items": {
                  "type": "string",
                  "title": "Line"
                }
              }
            }
          },
          {
            "type": "object",
            "title": "Var",
            "properties": {
              "var": {
                "type": "string"
              },
              "range": {
                "type": "string"
              },
              "doc": {
                "type" : "array",
                "format": "table",
                "title": "Doc",
                "items": {
                  "type": "string",
                  "title": "Line"
                }
              }
            }
          }
        ]
      },
      "default": [
        {
          "id": "sample_id",
          "doc": ["Sample ID doc"]
        },
        {
          "var": "sample_var",
          "doc": ["Sample var doc"]
        }
      ]
    },
    "features": {
      "type": "array",
      "format": "table",
      "title": "Features",
      "uniqueItems": true,
      "items": {
        "type": "object",
        "title": "Feature",
        "properties": {
          "feature": {
            "type": "string"
          },
          "doc": {
            "type" : "array",
            "format": "table",
            "title": "Doc",
            "items": {
              "type": "string",
              "title": "Line"
            }
          }
        }
      }
    },
    "table_map": {
      "type": "array",
      "format": "table",
      "title": "Table Map",
      "uniqueItems": true,
      "items": {
        "type": "object",
        "title": "Table",
		"properties": {
		  "name": {
		    "type": "string"
		  },
		  "number": {
		    "type": "number"
		  }
		}
      }
    },
    "flow_tables": {
      "type": "array",
      "format": "table",
      "title": "Flow Tables",
      "items": {
        "type": "object",
        "title": "Flow Table",
        "properties": {
          "name": {
            "type": "string"
          },
          "flow_mod_types": {
            "type": "array",
            "format": "table",
            "title": "Flow Mod Type",
            "items": {
              "type": "object",
              "title": "FlowModType",
			  "format": "grid",
              "properties": {
                "name": {
                  "type": "string"
                },
                "priority": {
                  "type": "string"
                },
                "match_set": {
                  "type": "array",
                  "format": "table",
                  "title": "Match Set",
                  "items": {
                    "type": "object",
                    "title": "Match Field",
                    "properties": {
                      "field": {
                        "type": "string",
                        "enum": [
                          "ACTSET_OUTPUT",
                          "ARP_OP",
                          "ARP_SHA",
                          "ARP_SPA",
                          "ARP_THA",
                          "ARP_TPA",
                          "ETH_DST",
                          "ETH_SRC",
                          "ETH_TYPE",
                          "ICMPV4_CODE",
                          "ICMPV4_TYPE",
                          "ICMPV6_CODE",
                          "ICMPV6_TYPE",
                          "IN_PHY_PORT",
                          "IN_PORT",
                          "IPV4_DST",
                          "IPV4_SRC",
                          "IPV6_DST",
                          "IPV6_EXTHDR",
                          "IPV6_FLABEL",
                          "IPV6_ND_SLL",
                          "IPV6_ND_TARGET",
                          "IPV6_ND_TLL",
                          "IPV6_SRC",
                          "IP_DSCP",
                          "IP_ECN",
                          "IP_PROTO",
                          "METADATA",
                          "MPLS_BOS",
                          "MPLS_LABEL",
                          "MPLS_TC",
                          "PACKET_TYPE",
                          "PBB_ISID",
                          "PBB_UCA",
                          "SCTP_DST",
                          "SCTP_SRC",
                          "TCP_DST",
                          "TCP_FLAGS",
                          "TCP_SRC",
                          "TUNNEL_ID",
                          "UDP_DST",
                          "UDP_SRC",
                          "VLAN_PCP",
                          "VLAN_VID"
                        ]
                      },
                      "match_type": {
                        "type": "string",
                        "enum": ["exact", "mask", "prefix", "all_or_exact"]
                      },
                      "mask": {
                        "type": "string"
                      },
                      "value": {
                        "type": "string"
                      },
                      "const_mask": {
                        "type": "string"
                      },
                      "const_value": {
                        "type": "string"
                      },
                      "doc": {
                        "type" : "array",
                        "format": "table",
                        "title": "Doc",
                        "items": {
                          "type": "string",
                          "title": "Line"
                        }
                      }
                    }
                  }
                },
                "instruction_set": {
                  "type": "array",
                  "format": "table",
                  "title": "Instruction Set",
                  "items": {
                    "oneOf": [
                      {
                        "type": "object",
                        "title": "Simple Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "CLEAR_ACTIONS",
                              "EXPERIMENTER",
                              "STAT_TRIGGER"
                            ]
                          }
                        }
                      },
                      {
                        "type": "object",
                        "title": "Action List Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "APPLY_ACTIONS",
                              "WRITE_ACTIONS"
                            ]
                          },
                          "actions": {
                            "type": "array",
                            "format": "table",
                            "title": "Actions",
                            "items": {
                              "type": "object",
                              "title": "Action",
                              "properties": {
                                "action": {
                                  "type": "string",
                                  "enum": [
                                    "COPY_FIELD",
                                    "COPY_TTL_IN",
                                    "COPY_TTL_OUT",
                                    "DEC_MPLS_TTL",
                                    "DEC_NW_TTL",
                                    "EXPERIMENTER",
                                    "GROUP",
                                    "OUTPUT",
                                    "POP_MPLS",
                                    "POP_PBB",
                                    "POP_VLAN",
                                    "PUSH_MPLS",
                                    "PUSH_PBB",
                                    "PUSH_VLAN",
                                    "SET_FIELD",
                                    "SET_MPLS_TTL",
                                    "SET_NW_TTL",
                                    "SET_QUEUE"
                                  ]
                                },
                                "port": {
                                  "type": "string"
                                },
                                "group_id": {
                                  "type": "string"
                                },
                                "queue_id": {
                                  "type": "string"
                                },
                                "ttl": {
                                  "type": "string"
                                },
                                "ethertype": {
                                  "type": "string"
                                },
                                "field": {
                                  "type": "string",
                                  "enum": [
                                    "ACTSET_OUTPUT",
                                    "ARP_OP",
                                    "ARP_SHA",
                                    "ARP_SPA",
                                    "ARP_THA",
                                    "ARP_TPA",
                                    "ETH_DST",
                                    "ETH_SRC",
                                    "ETH_TYPE",
                                    "ICMPV4_CODE",
                                    "ICMPV4_TYPE",
                                    "ICMPV6_CODE",
                                    "ICMPV6_TYPE",
                                    "IN_PHY_PORT",
                                    "IN_PORT",
                                    "IPV4_DST",
                                    "IPV4_SRC",
                                    "IPV6_DST",
                                    "IPV6_EXTHDR",
                                    "IPV6_FLABEL",
                                    "IPV6_ND_SLL",
                                    "IPV6_ND_TARGET",
                                    "IPV6_ND_TLL",
                                    "IPV6_SRC",
                                    "IP_DSCP",
                                    "IP_ECN",
                                    "IP_PROTO",
                                    "METADATA",
                                    "MPLS_BOS",
                                    "MPLS_LABEL",
                                    "MPLS_TC",
                                    "PACKET_TYPE",
                                    "PBB_ISID",
                                    "PBB_UCA",
                                    "SCTP_DST",
                                    "SCTP_SRC",
                                    "TCP_DST",
                                    "TCP_FLAGS",
                                    "TCP_SRC",
                                    "TUNNEL_ID",
                                    "UDP_DST",
                                    "UDP_SRC",
                                    "VLAN_PCP",
                                    "VLAN_VID"
                                  ]
                                },
                                "value": {
                                  "type": "string"
                                },
                                "doc": {
                                  "type" : "array",
                                  "format": "table",
                                  "title": "Doc",
                                  "items": {
                                    "type": "string",
                                    "title": "Line"
                                  }
                                }
                              }
                            }
                          }
                          }
                      },
                      {
                        "type": "object",
                        "title": "Goto Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "GOTO_TABLE"
                            ]
                          },
                          "table": {
                            "type": "string"
                          }
                        }
                      },
                      {
                        "type": "object",
                        "title": "Metadata Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "WRITE_METADATA"
                            ]
                          },
                          "metadata": {
                            "type": "integer"
                          },
                          "metadata_mask": {
                            "type": "integer"
                          }
                        }
                      }
                    ]
                  }
                },
                "doc": {
                  "type" : "array",
                  "format": "table",
                  "title": "Doc",
                  "items": {
                    "type": "string",
                    "title": "Line"
                  }
                }
              }
            }
          },
          "built_in_flow_mods": {
            "type": "array",
            "format": "table",
            "title": "Built In Flow Mods",
            "items": {
              "type": "object",
              "title": "BuiltInFlowMod",
              "properties": {
                "name": {
                  "type": "string"
                },
                "priority": {
                  "type": "string"
                },
                "match_set": {
                  "type": "array",
                  "format": "table",
                  "title": "Match Set",
                  "items": {
                    "type": "object",
                    "title": "Match Field",
                    "properties": {
                      "field": {
                        "type": "string",
                        "enum": [
                          "ACTSET_OUTPUT",
                          "ARP_OP",
                          "ARP_SHA",
                          "ARP_SPA",
                          "ARP_THA",
                          "ARP_TPA",
                          "ETH_DST",
                          "ETH_SRC",
                          "ETH_TYPE",
                          "ICMPV4_CODE",
                          "ICMPV4_TYPE",
                          "ICMPV6_CODE",
                          "ICMPV6_TYPE",
                          "IN_PHY_PORT",
                          "IN_PORT",
                          "IPV4_DST",
                          "IPV4_SRC",
                          "IPV6_DST",
                          "IPV6_EXTHDR",
                          "IPV6_FLABEL",
                          "IPV6_ND_SLL",
                          "IPV6_ND_TARGET",
                          "IPV6_ND_TLL",
                          "IPV6_SRC",
                          "IP_DSCP",
                          "IP_ECN",
                          "IP_PROTO",
                          "METADATA",
                          "MPLS_BOS",
                          "MPLS_LABEL",
                          "MPLS_TC",
                          "PACKET_TYPE",
                          "PBB_ISID",
                          "PBB_UCA",
                          "SCTP_DST",
                          "SCTP_SRC",
                          "TCP_DST",
                          "TCP_FLAGS",
                          "TCP_SRC",
                          "TUNNEL_ID",
                          "UDP_DST",
                          "UDP_SRC",
                          "VLAN_PCP",
                          "VLAN_VID"
                        ]
                      },
                      "match_type": {
                        "type": "string",
                        "enum": ["exact", "mask", "prefix", "all_or_exact"]
                      },
                      "mask": {
                        "type": "string"
                      },
                      "value": {
                        "type": "string"
                      },
                      "const_mask": {
                        "type": "string"
                      },
                      "const_value": {
                        "type": "string"
                      },
                      "doc": {
                        "type" : "array",
                        "format": "table",
                        "title": "Doc",
                        "items": {
                          "type": "string",
                          "title": "Line"
                        }
                      }
                    }
                  }
                },
                "instruction_set": {
                  "type": "array",
                  "format": "table",
                  "title": "Instruction Set",
                  "items": {
                    "oneOf": [
                      {
                        "type": "object",
                        "title": "Simple Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "CLEAR_ACTIONS",
                              "EXPERIMENTER",
                              "STAT_TRIGGER"
                            ]
                          }
                        }
                      },
                      {
                        "type": "object",
                        "title": "Action List Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "APPLY_ACTIONS",
                              "WRITE_ACTIONS"
                            ]
                          },
                          "actions": {
                            "type": "array",
                            "format": "table",
                            "title": "Actions",
                            "items": {
                              "type": "object",
                              "title": "Action",
                              "properties": {
                                "action": {
                                  "type": "string",
                                  "enum": [
                                    "COPY_FIELD",
                                    "COPY_TTL_IN",
                                    "COPY_TTL_OUT",
                                    "DEC_MPLS_TTL",
                                    "DEC_NW_TTL",
                                    "EXPERIMENTER",
                                    "GROUP",
                                    "OUTPUT",
                                    "POP_MPLS",
                                    "POP_PBB",
                                    "POP_VLAN",
                                    "PUSH_MPLS",
                                    "PUSH_PBB",
                                    "PUSH_VLAN",
                                    "SET_FIELD",
                                    "SET_MPLS_TTL",
                                    "SET_NW_TTL",
                                    "SET_QUEUE"
                                  ]
                                },
                                "port": {
                                  "type": "string"
                                },
                                "group_id": {
                                  "type": "string"
                                },
                                "queue_id": {
                                  "type": "string"
                                },
                                "ttl": {
                                  "type": "string"
                                },
                                "ethertype": {
                                  "type": "string"
                                },
                                "field": {
                                  "type": "string",
                                  "enum": [
                                    "ACTSET_OUTPUT",
                                    "ARP_OP",
                                    "ARP_SHA",
                                    "ARP_SPA",
                                    "ARP_THA",
                                    "ARP_TPA",
                                    "ETH_DST",
                                    "ETH_SRC",
                                    "ETH_TYPE",
                                    "ICMPV4_CODE",
                                    "ICMPV4_TYPE",
                                    "ICMPV6_CODE",
                                    "ICMPV6_TYPE",
                                    "IN_PHY_PORT",
                                    "IN_PORT",
                                    "IPV4_DST",
                                    "IPV4_SRC",
                                    "IPV6_DST",
                                    "IPV6_EXTHDR",
                                    "IPV6_FLABEL",
                                    "IPV6_ND_SLL",
                                    "IPV6_ND_TARGET",
                                    "IPV6_ND_TLL",
                                    "IPV6_SRC",
                                    "IP_DSCP",
                                    "IP_ECN",
                                    "IP_PROTO",
                                    "METADATA",
                                    "MPLS_BOS",
                                    "MPLS_LABEL",
                                    "MPLS_TC",
                                    "PACKET_TYPE",
                                    "PBB_ISID",
                                    "PBB_UCA",
                                    "SCTP_DST",
                                    "SCTP_SRC",
                                    "TCP_DST",
                                    "TCP_FLAGS",
                                    "TCP_SRC",
                                    "TUNNEL_ID",
                                    "UDP_DST",
                                    "UDP_SRC",
                                    "VLAN_PCP",
                                    "VLAN_VID"
                                  ]
                                },
                                "value": {
                                  "type": "string"
                                },
                                "doc": {
                                  "type" : "array",
                                  "format": "table",
                                  "title": "Doc",
                                  "items": {
                                    "type": "string",
                                    "title": "Line"
                                  }
                                }
                              }
                            }
                          }
                          }
                      },
                      {
                        "type": "object",
                        "title": "Goto Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "GOTO_TABLE"
                            ]
                          },
                          "table": {
                            "type": "string"
                          }
                        }
                      },
                      {
                        "type": "object",
                        "title": "Metadata Inst",
                        "properties": {
                          "instruction": {
                            "type": "string",
                            "enum": [
                              "WRITE_METADATA"
                            ]
                          },
                          "metadata": {
                            "type": "integer"
                          },
                          "metadata_mask": {
                            "type": "integer"
                          }
                        }
                      }
                    ]
                  }
                },
                "doc": {
                  "type" : "array",
                  "format": "table",
                  "title": "Doc",
                  "items": {
                    "type": "string",
                    "title": "Line"
                  }
                }
              }
            }
          },
          "doc": {
            "type" : "array",
            "format": "table",
            "title": "Doc",
            "items": {
              "type": "string",
              "title": "Line"
            }
          }
        }
      }
    },
    "group_entry_types": {
      "type": "object",
      "title": "Group Entry Types",
      "properties": {
        "name": {
          "type": "string"
        },
        "group_type": {
          "type": "string",
          "enum": [
            "ALL", "SELECT", "INDIRECT", "FF"
          ]
        },
        "bucket_types": {
          "type": "array",
          "format": "table",
          "title": "Bucket Types",
          "items": {
            "type": "object",
            "title": "Bucket",
            "properties": {
              "name": {
                "type": "string"
              },
              "action_set": {
                "type": "array",
                "format": "table",
                "title": "Action List",
                "items": {
                  "type": "object",
                  "title": "Action",
                  "properties": {
                    "action": {
                      "type": "string",
                      "enum": [
                        "COPY_FIELD",
                        "COPY_TTL_IN",
                        "COPY_TTL_OUT",
                        "DEC_MPLS_TTL",
                        "DEC_NW_TTL",
                        "EXPERIMENTER",
                        "GROUP",
                        "OUTPUT",
                        "POP_MPLS",
                        "POP_PBB",
                        "POP_VLAN",
                        "PUSH_MPLS",
                        "PUSH_PBB",
                        "PUSH_VLAN",
                        "SET_FIELD",
                        "SET_MPLS_TTL",
                        "SET_NW_TTL",
                        "SET_QUEUE"
                      ]
                    },
                    "port": {
                      "type": "string"
                    },
                    "group_id": {
                      "type": "string"
                    },
                    "queue_id": {
                      "type": "string"
                    },
                    "ttl": {
                      "type": "string"
                    },
                    "ethertype": {
                      "type": "string"
                    },
                    "field": {
                      "type": "string",
                      "enum": [
                        "ACTSET_OUTPUT",
                        "ARP_OP",
                        "ARP_SHA",
                        "ARP_SPA",
                        "ARP_THA",
                        "ARP_TPA",
                        "ETH_DST",
                        "ETH_SRC",
                        "ETH_TYPE",
                        "ICMPV4_CODE",
                        "ICMPV4_TYPE",
                        "ICMPV6_CODE",
                        "ICMPV6_TYPE",
                        "IN_PHY_PORT",
                        "IN_PORT",
                        "IPV4_DST",
                        "IPV4_SRC",
                        "IPV6_DST",
                        "IPV6_EXTHDR",
                        "IPV6_FLABEL",
                        "IPV6_ND_SLL",
                        "IPV6_ND_TARGET",
                        "IPV6_ND_TLL",
                        "IPV6_SRC",
                        "IP_DSCP",
                        "IP_ECN",
                        "IP_PROTO",
                        "METADATA",
                        "MPLS_BOS",
                        "MPLS_LABEL",
                        "MPLS_TC",
                        "PACKET_TYPE",
                        "PBB_ISID",
                        "PBB_UCA",
                        "SCTP_DST",
                        "SCTP_SRC",
                        "TCP_DST",
                        "TCP_FLAGS",
                        "TCP_SRC",
                        "TUNNEL_ID",
                        "UDP_DST",
                        "UDP_SRC",
                        "VLAN_PCP",
                        "VLAN_VID"
                      ]
                    },
                    "value": {
                      "type": "string"
                    },
                    "doc":  {
                      "type" : "array",
                      "format": "table",
                      "title": "Doc",
                      "items": {
                        "type": "string",
                        "title": "Line"
                      }
                    }
                  }
                }
              },
              "doc":  {
                "type" : "array",
                "format": "table",
                "title": "Doc",
                "items": {
                  "type": "string",
                  "title": "Line"
                }
              }
            }
          }
        },
        "doc": {
          "type" : "array",
          "format": "table",
          "title": "Doc",
          "items": {
            "type": "string",
            "title": "Line"
          }
        }
      }
    },
    "packet_out": {
      "type": "array",
      "format": "table",
      "title": "Packet Out",
      "items": {
        "type": "array",
        "format": "table",
        "title": "Action List",
        "items": {
          "type": "object",
          "title": "Action",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "COPY_FIELD",
                "COPY_TTL_IN",
                "COPY_TTL_OUT",
                "DEC_MPLS_TTL",
                "DEC_NW_TTL",
                "EXPERIMENTER",
                "GROUP",
                "OUTPUT",
                "POP_MPLS",
                "POP_PBB",
                "POP_VLAN",
                "PUSH_MPLS",
                "PUSH_PBB",
                "PUSH_VLAN",
                "SET_FIELD",
                "SET_MPLS_TTL",
                "SET_NW_TTL",
                "SET_QUEUE"
              ]
            },
            "port": {
              "type": "string"
            },
            "group_id": {
              "type": "string"
            },
            "queue_id": {
              "type": "string"
            },
            "ttl": {
              "type": "string"
            },
            "ethertype": {
              "type": "string"
            },
            "field": {
              "type": "string",
              "enum": [
                "ACTSET_OUTPUT",
                "ARP_OP",
                "ARP_SHA",
                "ARP_SPA",
                "ARP_THA",
                "ARP_TPA",
                "ETH_DST",
                "ETH_SRC",
                "ETH_TYPE",
                "ICMPV4_CODE",
                "ICMPV4_TYPE",
                "ICMPV6_CODE",
                "ICMPV6_TYPE",
                "IN_PHY_PORT",
                "IN_PORT",
                "IPV4_DST",
                "IPV4_SRC",
                "IPV6_DST",
                "IPV6_EXTHDR",
                "IPV6_FLABEL",
                "IPV6_ND_SLL",
                "IPV6_ND_TARGET",
                "IPV6_ND_TLL",
                "IPV6_SRC",
                "IP_DSCP",
                "IP_ECN",
                "IP_PROTO",
                "METADATA",
                "MPLS_BOS",
                "MPLS_LABEL",
                "MPLS_TC",
                "PACKET_TYPE",
                "PBB_ISID",
                "PBB_UCA",
                "SCTP_DST",
                "SCTP_SRC",
                "TCP_DST",
                "TCP_FLAGS",
                "TCP_SRC",
                "TUNNEL_ID",
                "UDP_DST",
                "UDP_SRC",
                "VLAN_PCP",
                "VLAN_VID"
              ]
            },
            "value": {
              "type": "string"
            },
            "doc":  {
              "type" : "array",
              "format": "table",
              "title": "Doc",
              "items": {
                "type": "string",
                "title": "Line"
              }
            }
          }
        }
      }
    },
    "parameters": {
      "type": "array",
      "format": "table",
      "title": "Parameters",
      "items": {
        "type": "object",
        "title": "Parameter",
        "properties": {
          "name": {
            "type" : "string"
          },
          "type": {
            "type" : "string"
          },
          "default": {
            "type" : "string"
          },
          "doc":  {
            "type" : "array",
            "format": "table",
            "title": "Doc",
            "items": {
              "type": "string",
              "title": "Line"
            }
          }
        }
      }
    },
    "flow_paths": {
      "type": "array",
      "format": "table",
      "title": "Flow Paths",
      "items": {
        "type": "object",
        "title": "Flow Path Item",
        "properties": {
          "name":  {
            "type" : "string"
          },
          "path":  {
            "type" : "array",
            "format": "table",
            "title": "Paths",
            "items": {
              "type": "string",
              "title": "Path"
            }
          },
          "no-path":  {
            "type" : "array",
            "format": "table",
            "title": "No Paths",
            "items": {
              "type": "string",
              "title": "No Path Item"
            }
          },
          "doc":  {
            "type" : "array",
            "format": "table",
            "title": "Doc",
            "items": {
              "type": "string",
              "title": "Line"
            }
          }
        }
      }
    },
    "security": {
      "type": "object",
      "title": "Security",
      "properties": {
        "doc": {
          "type" : "array",
          "format": "table",
          "title": "Doc",
          "items": {
            "type": "string",
            "title": "Line"
          }
        }
      }
    }
  }
}
    }

    // Divs/textareas on the page
    var $schema = document.getElementById('schema');
    var $output = document.getElementById('output');
    var $editor = document.getElementById('editor');
    var $validate = document.getElementById('validate');

    // Buttons
    var $set_schema_button = document.getElementById('setschema');
    var $set_value_button = document.getElementById('setvalue');

    var jsoneditor;

    var reload = function(keep_value) {
        var startval = (jsoneditor && keep_value)? jsoneditor.getValue() : window.startval;
        window.startval = undefined;

        if(jsoneditor) jsoneditor.destroy();
        jsoneditor = new JSONEditor($editor,{
            schema: schema,
            startval: startval
        });
        window.jsoneditor = jsoneditor;

        // When the value of the editor changes, update the JSON output and validation message
        jsoneditor.on('change',function() {
            var json = jsoneditor.getValue();

            $output.value = JSON.stringify(json,null,2);

            var validation_errors = jsoneditor.validate();
            // Show validation errors if there are any
            if(validation_errors.length) {
                $validate.value = JSON.stringify(validation_errors,null,2);
            }
            else {
                $validate.value = 'valid';
            }
        });
    };

    // Start the schema and output textareas with initial values
    $schema.value = JSON.stringify(schema,null,2);
    $output.value = '';

    // When the 'update form' button is clicked, set the editor's value
    $set_value_button.addEventListener('click',function() {
        jsoneditor.setValue(JSON.parse($output.value));
    });

    // Update the schema when the button is clicked
    $set_schema_button.addEventListener('click',function() {
        try {
            schema = JSON.parse($schema.value);
        }
        catch(e) {
            alert('Invalid Schema: '+e.message);
            return;
        }

        reload();
    });

    // Set the theme by loading the right stylesheets
    var setTheme = function(theme,no_reload) {
        theme = theme || '';

        var mapping = {
            html: '',
            bootstrap2: 'http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css',
            bootstrap3: 'http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css',
            foundation3: 'http://cdnjs.cloudflare.com/ajax/libs/foundation/3.2.5/stylesheets/foundation.css',
            foundation4: 'http://cdn.jsdelivr.net/foundation/4.3.2/css/foundation.min.css',
            foundation5: 'http://cdn.jsdelivr.net/foundation/5.0.2/css/foundation.min.css',
            jqueryui: 'http://code.jquery.com/ui/1.10.3/themes/south-street/jquery-ui.css'
        };

        if(typeof mapping[theme] === 'undefined') {
            theme = 'bootstrap3';
            document.getElementById('theme_switcher').value = theme;
        }

        JSONEditor.defaults.options.theme = theme;

        document.getElementById('theme_stylesheet').href = mapping[theme];
        document.getElementById('theme_switcher').value = JSONEditor.defaults.options.theme;

        if(!no_reload) reload(true);
    };

    // Set the icontheme
    // Set the theme by loading the right stylesheets
    var setIconlib = function(iconlib,no_reload) {
        iconlib = iconlib || '';
        var mapping = {
            foundation2: 'http://cdnjs.cloudflare.com/ajax/libs/foundicons/2.0/stylesheets/general_foundicons.css',
            foundation3: 'http://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css',
            fontawesome3: 'http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.css',
            fontawesome4: 'http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css'
        };

        JSONEditor.defaults.options.iconlib = iconlib;

        document.getElementById('icon_stylesheet').href = mapping[iconlib] || '';
        document.getElementById('icon_switcher').value = JSONEditor.defaults.options.iconlib;

        if(!no_reload) reload(true);
    };

    var refreshBooleanOptions = function(no_reload) {
        var boolean_options = document.getElementById('boolean_options').children;
        for(var i=0; i<boolean_options.length; i++) {
            JSONEditor.defaults.options[boolean_options[i].value] = boolean_options[i].selected;
        }
        if(!no_reload) reload(true);
    };

    // Change listeners for options
    document.getElementById('theme_switcher').addEventListener('change',function() {
        setTheme(this.value);
    });
    document.getElementById('icon_switcher').addEventListener('change',function() {
        setIconlib(this.value);
    });
    document.getElementById('object_layout').addEventListener('change',function() {
       JSONEditor.defaults.options.object_layout = this.value;
        reload(true);
    });
    document.getElementById('show_errors').addEventListener('change',function() {
       JSONEditor.defaults.options.show_errors = this.value;
        reload(true);
    });
    document.getElementById('boolean_options').addEventListener('change',function() {
        refreshBooleanOptions();
    });
    
    // Get starting value from url
    if(window.location.href.match('[?&]value=([^&]+)')) {
      window.startval = JSON.parse(LZString.decompressFromBase64(window.location.href.match('[?&]value=([^&]+)')[1]));
    }
 
    // Set options from direct link
    setTheme('bootstrap2', true);
    
    setIconlib('fontawesome4', true);
    
    document.getElementById('object_layout').value = 'normal';
    JSONEditor.defaults.options.object_layout = document.getElementById('object_layout').value;
    
    document.getElementById('show_errors').value = (window.location.href.match(/[?&]show_errors=([^&]+)/)||[])[1] || 'interaction';
    JSONEditor.defaults.options.show_errors = document.getElementById('show_errors').value;
    
    var boolean_options = document.getElementById('boolean_options').children;
    for(var i=0; i<boolean_options.length; i++) {
        if(window.location.href.match(new RegExp('[?&]'+boolean_options[i].getAttribute('value')+'([&=]|$)'))) {
            boolean_options[i].selected = true;
        }
    }
    refreshBooleanOptions(true);
    
    reload();
})();
</script>
</html>
